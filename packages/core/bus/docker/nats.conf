# ═══════════════════════════════════════════════════════════════════════════════
# NATS Server Configuration for Nachos Message Bus
# ═══════════════════════════════════════════════════════════════════════════════
#
# This configuration file sets up NATS for use as the Nachos internal message bus.
# Documentation: https://docs.nats.io/running-a-nats-service/configuration
#
# ═══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────────
# Server Identity
# ─────────────────────────────────────────────────────────────────────────────────
server_name: nachos-bus

# ─────────────────────────────────────────────────────────────────────────────────
# Client Connections
# ─────────────────────────────────────────────────────────────────────────────────
port: 4222
listen: 0.0.0.0

# Maximum connections allowed
max_connections: 1000

# Maximum payload size (1MB default)
max_payload: 1048576

# Ping/pong interval and max outstanding pings before disconnect
ping_interval: "30s"
ping_max: 2

# Connection timeout
write_deadline: "10s"

# ─────────────────────────────────────────────────────────────────────────────────
# HTTP Monitoring
# ─────────────────────────────────────────────────────────────────────────────────
http_port: 8222

# ─────────────────────────────────────────────────────────────────────────────────
# Logging
# ─────────────────────────────────────────────────────────────────────────────────
# Log to stdout for Docker logging
debug: false
trace: false
logtime: true
log_file: ""

# ─────────────────────────────────────────────────────────────────────────────────
# Resource Limits
# ─────────────────────────────────────────────────────────────────────────────────
# Maximum memory usage (256MB)
max_control_line: 4096

# Slow consumer handling
max_pending: 67108864

# ─────────────────────────────────────────────────────────────────────────────────
# Cluster (disabled for single-node deployment)
# ─────────────────────────────────────────────────────────────────────────────────
# cluster {
#   name: nachos-cluster
#   port: 6222
# }

# ─────────────────────────────────────────────────────────────────────────────────
# JetStream (optional persistence - disabled by default)
# ─────────────────────────────────────────────────────────────────────────────────
# jetstream {
#   store_dir: /data
#   max_memory_store: 256MB
#   max_file_store: 1GB
# }
