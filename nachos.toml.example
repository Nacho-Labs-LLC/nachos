# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ§€ NACHOS CONFIGURATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# This is your single configuration file for the entire Nachos stack.
# Edit this file and run `nachos up` to apply changes.
#
# Documentation: https://nachos.dev/docs/configuration
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[nachos]
name = "my-assistant"
version = "1.0"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ¥© THE PROTEIN - Your LLM Provider
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Choose your AI backend. Credentials come from environment variables or .env file.

[llm]
provider = "anthropic"                    # "anthropic" | "openai" | "ollama" | "custom"
model = "claude-sonnet-4-20250514"        # Default model
fallback_order = ["anthropic:claude-haiku"] # Used if primary fails
max_tokens = 4096                         # Max response tokens
temperature = 0.7                         # 0.0 = deterministic, 1.0 = creative

# For Ollama (local models):
# [llm]
# provider = "ollama"
# model = "llama3.2"
# base_url = "http://host.docker.internal:11434"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ«‘ TOPPINGS - Channels
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Enable the messaging platforms you want to connect.
# Credentials come from environment variables (SLACK_BOT_TOKEN, etc.)

[channels.webchat]
enabled = true
port = 8080                               # Local port for web interface
# No authentication required for local webchat

[channels.slack]
enabled = false
mode = "socket"                           # "socket" | "http"
app_token = "${SLACK_APP_TOKEN}"
bot_token = "${SLACK_BOT_TOKEN}"
# For HTTP mode:
# signing_secret = "${SLACK_SIGNING_SECRET}"
# webhook_path = "/slack/events"

[[channels.slack.servers]]
id = "T123456"
channel_ids = ["C111", "C222"]
user_allowlist = ["U123", "U456"]

[channels.discord]
enabled = false
token = "${DISCORD_BOT_TOKEN}"

[[channels.discord.servers]]
id = "1234567890"
channel_ids = ["111", "222"]
user_allowlist = ["user_a", "user_b"]

[channels.telegram]
enabled = false
token = "${TELEGRAM_BOT_TOKEN}"

[[channels.telegram.servers]]
id = "9876543210"
channel_ids = ["333", "444"]
user_allowlist = ["user_c", "user_d"]

[channels.whatsapp]
enabled = false
token = "${WHATSAPP_TOKEN}"
phone_number_id = "${WHATSAPP_PHONE_NUMBER_ID}"
verify_token = "${WHATSAPP_VERIFY_TOKEN}"
app_secret = "${WHATSAPP_APP_SECRET}" # Optional: enables signature verification
webhook_path = "/whatsapp/webhook"
api_version = "v20.0"

[channels.whatsapp.dm]
user_allowlist = ["15551234567"]



# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ«‘ MORE TOPPINGS - Tools
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Enable capabilities for your assistant.

[tools.filesystem]
enabled = true
paths = ["./workspace"]                   # Directories the assistant can access
write = true                              # Allow write operations
max_file_size = "10MB"                    # Limit for file operations

[tools.browser]
enabled = true
allowed_domains = ["*"]                   # Restrict if needed: ["docs.google.com", "github.com"]
headless = true                           # Run browser without GUI
timeout = 30                              # Page load timeout in seconds

[tools.code_runner]
enabled = true
runtime = "sandboxed"                     # "sandboxed" (safe) | "native" (requires opt-in)
languages = ["python", "javascript", "typescript"]
timeout = 30                              # Execution timeout in seconds
max_memory = "256MB"                      # Memory limit per execution

[tools.shell]
enabled = false                           # Disabled by default - high risk
# To enable, you must also set security.mode = "permissive"

[tools.web_search]
enabled = false
# Requires: SERP_API_KEY or similar in .env

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸŒ¶ï¸ THE SALSA - Security Configuration
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Security is on by default. Adjust these settings carefully.

[security]
mode = "standard"                         # "strict" | "standard" | "permissive"

# Strict: Everything disabled, allowlist only, full audit
# Standard: Common tools enabled, pairing DMs, balanced security  
# Permissive: Full access (requires i_understand_the_risks = true)

# Required only for permissive mode:
# i_understand_the_risks = true

[security.dlp]
enabled = true
action = "warn"                           # "block" | "warn" | "audit" | "allow" | "redact"
patterns = [
    "credit_card",
    "ssn", 
    "api_key",
    "password"
]

[security.approval]
approver_allowlist = ["U123", "U456"]   # Optional: allowlisted approvers for restricted tools

[security.rate_limits]
messages_per_minute = 30
tool_calls_per_minute = 15
llm_requests_per_minute = 30

[security.audit]
enabled = true
retention_days = 30
log_inputs = true                         # Log user messages (redacted)
log_outputs = true                        # Log assistant responses
log_tool_calls = true                     # Log all tool invocations

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ½ï¸ THE PLATE - Runtime Configuration
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[runtime]
state_dir = "./state"                     # Persistent state storage
config_dir = "./config"                   # Optional: config directory mounted into sandboxes
workspace_dir = "./workspace"             # Optional: workspace directory mounted into sandboxes
log_level = "info"                        # "debug" | "info" | "warn" | "error"
log_format = "pretty"                     # "pretty" | "json"
redis_url = "redis://localhost:6379"

# Pairing (DMs): set NACHOS_PAIRING_TOKEN in your environment to require a token

[runtime.resources]
# Default resource limits per container
memory = "512MB"
cpus = 0.5
pids_limit = 100

# State Layer storage (identity, memory, session state)
[runtime.state]

[runtime.state.identity]
provider = "filesystem"                   # "filesystem" | "postgres"
[runtime.state.identity.filesystem]
dir = "./state/identity"
# [runtime.state.identity.postgres]
# connection_string = "postgres://user:pass@localhost:5432/nachos"
# schema = "public"

[runtime.state.memory]
provider = "filesystem"
[runtime.state.memory.filesystem]
dir = "./state/memory"
# [runtime.state.memory.postgres]
# connection_string = "postgres://user:pass@localhost:5432/nachos"
# schema = "public"

[runtime.state.session]
provider = "redis"                        # "redis" | "memory"
redis_url = "redis://localhost:6379"
ttl_seconds = 86400

[runtime.state.prompt_report]
hash = "sha256"
include_tokens = true
max_memory_entries = 50
max_memory_facts = 50
include_session_state = false

# Context management (memory flush example)
[runtime.context_management.memory_flush]
enabled = true
soft_threshold_tokens = 4000
extract_structured = true
create_snapshot = true
validate_extraction = true

# Subagent sandboxing
[runtime.subagents]
enabled = false
max_concurrent = 1

[runtime.subagents.announce]
enabled = true
# prompt = """
# Status: <success|failed|cancelled>
# Result: <short summary>
# Notes: <optional>
# Stats: durationMs=<number> sandboxed=<true|false>
# """

[runtime.subagents.tools]
# deny wins; if allow is set, only allow those tools
deny = ["sessions_list", "sessions_history", "sessions_send", "sessions_spawn"]
# allow = ["filesystem_read", "browser"]
default_profile = "engineering"

# Tool profiles let you tailor access per subagent task type.
[runtime.subagents.tools.profiles.research]
allow = ["filesystem_read", "browser", "web_search"]
deny = ["filesystem_write", "code_runner"]

[runtime.subagents.tools.profiles.frontend]
allow = ["filesystem_read", "filesystem_write", "browser", "code_runner"]

[runtime.subagents.tools.profiles.qa]
allow = ["filesystem_read", "code_runner"]
deny = ["filesystem_write"]

[runtime.subagents.tools.profiles.devops]
allow = ["filesystem_read", "filesystem_write", "code_runner"]
deny = ["shell"]

[runtime.subagents.tools.profiles.security_audit]
allow = ["filesystem_read", "web_search"]
deny = ["filesystem_write", "code_runner"]

[runtime.subagents.tools.profiles.engineering]
allow = ["filesystem_read", "filesystem_write", "code_runner", "browser"]

[runtime.subagents.sandbox]
mode = "full"                              # "host" | "tool" | "full"

[runtime.subagents.sandbox.docker]
image = "nachos/subagent:latest"
network = "egress"                         # "none" | "egress" | "full"
workspace_dir = "./workspace"
config_dir = "./config"
state_dir = "./state"
timeout_ms = 300000

# Tool sandboxing (optional)
[runtime.sandbox]
mode = "off"                               # "off" | "non-main" | "all"
scope = "session"                          # "session" | "agent" | "shared"
workspace_access = "rw"                    # "none" | "ro" | "rw"
# extra_binds = ["/host/path:/container/path:ro"]
# env = { KEY = "value" }
# setup_command = "echo setup"
# network = "egress"                       # "none" | "egress" | "full"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ¨ PERSONALITY - Assistant Configuration
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[assistant]
name = "Nachos"
system_prompt = """
You are a helpful AI assistant running in the Nachos framework.
You have access to various tools based on your configuration.
Be concise, helpful, and security-conscious.
"""

# Load additional context from files:
# context_files = ["./skills/researcher.md", "./context/company.md"]

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“¦ SKILLS - Pre-configured Tool + Prompt Bundles
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[skills]
enabled = []                              # ["researcher", "coder", "writer"]

# Skills are pre-configured bundles that enable specific tools and prompts.
# Browse available skills: nachos search skills
# Add a skill: nachos add skill researcher
